import{r as d,C as _,i as A,u as M,R as e,L as i,J as $,K as I,M as S,N as F,O as P,P as j}from"./main-faf44e1c.js";import{d as B,R as L}from"./Other-7d28e6c9.js";import"./index-507c5bbd.js";function q(){const c=d.useContext(_),[s,n]=d.useState({editModes:{},editedText:"",teamData:null,teamActivity:null,teamMembers:null,loading:!0,error:null,inviteFormData:{email:"",access:"Convidado"}}),{teamId:m}=A(),{t:l}=M(),o=c.user._userId;d.useEffect(()=>{(async()=>{try{if(c.user._isAuth){const t=await $(m);n(r=>({...r,teamData:t.team,teamMembers:t.teamMembers,teamActivity:t.teamActivity,loading:!1}))}else n(t=>({...t,loading:!1}))}catch(t){n(r=>({...r,error:t.message,loading:!1}))}})()},[c.user._isAuth,m]);const u=s.teamActivity?[...s.teamActivity].sort((a,t)=>new Date(t.CreateDate)-new Date(a.CreateDate)):[],N=s.teamMembers?s.teamMembers.filter(a=>a.access==="Administrador"):[],g=async()=>{const{email:a}=s.inviteFormData;if(!a.trim()){alert("Por favor, insira um endereço de e-mail válido.");return}try{await I(m,s.inviteFormData),window.location.reload()}catch(t){console.error("Erro ao enviar o convite:",t.message)}},h=async()=>{try{await S(m,o),window.location.reload()}catch(a){console.error(a.message)}},f=async a=>{try{await F(m,a.target.checked?1:0),window.location.reload()}catch(t){console.error("Erro ao atualizar o estado da equipa:",t.message)}},y=a=>n(t=>({...t,editModes:{...t.editModes,[a]:!1}})),x=(a,t)=>n(r=>({...r,editModes:{[a]:!0},editedText:t.descriptionActivityTeam})),w=async a=>{try{await P(a),window.location.reload()}catch(t){console.error("Erro ao eliminar membro da equipa:",t.message)}},k=async a=>{try{await j(a,s.editedText),window.location.reload()}catch(t){console.error("Erro ao guardar atividade actualizada:",t.message)}},T=a=>n(t=>({...t,editedText:a})),p=a=>{const{id:t,value:r}=a.target;n(b=>({...b,inviteFormData:{...b.inviteFormData,[t]:r}}))},D=a=>{const t=new Date(a),r=new Date;return t.toDateString()===r.toDateString()?t.toLocaleTimeString("default",{hour:"numeric",minute:"numeric"}):t.toLocaleDateString("default",{day:"numeric",month:"long",year:"numeric"})},C=a=>{const t=["Bytes","KB","MB","GB","TB"],r=Math.floor(Math.log(a)/Math.log(1024));return`${(a/Math.pow(1024,r)).toFixed(2)} ${t[r]}`};if(s.loading)return e.createElement("p",null,"Loading...");if(s.error)return e.createElement("p",null,"Error: ",s.error);const E=s.teamMembers&&s.teamMembers.some(a=>a.users.idTeacher===o),v=s.teamMembers&&s.teamMembers.some(a=>a.users.idTeacher===o&&a.access==="Administrador");return e.createElement("div",null,e.createElement("main",{id:"content",role:"main",className:"container mt-4"},e.createElement("div",{className:"content container-fluid my-2 card rounded shadow-sm"},e.createElement("div",{className:"row align-items-end"},e.createElement("div",{className:"col-sm"},e.createElement("nav",{"aria-label":"breadcrumb"},e.createElement("ol",{className:"breadcrumb breadcrumb-no-gutter pt-3"},e.createElement("li",{className:"breadcrumb-item"},e.createElement(i,{to:`/team/${s.teamData.idTeam}`},l("teams")," - ",s.teamData.idTeam)))),e.createElement("h1",{className:"page-header-title"},"#",s.teamData.nameTeam),e.createElement("p",null,s.teamData.descriptionTeam),e.createElement("div",{className:"d-flex justify-content-between align-items-center"},e.createElement("span",{className:"text-dark pb-3"},l("team_status"),e.createElement("div",{className:`form-text badge bg-soft-primary text-${s.teamData.privacy===1?"success":"danger"} rounded-pill me-1`},s.teamData.privacy===1?"Publico":"Privado"," ",e.createElement("i",{className:`bi bi-${s.teamData.privacy===1?"globe2":"lock"}`}))),e.createElement("span",{className:"card-subtitle pb-3"},l("industry")," ",e.createElement("a",{className:"form-text badge bg-soft-primary text-primary rounded-pill me-1",href:"#"},s.teamData.areasWork)))))),e.createElement("div",{className:"row mt-4 mb-4"},e.createElement("div",{className:"col-lg-4"},e.createElement("div",{className:"js-sticky-block card mb-3 mb-lg-5"},e.createElement("div",{className:"card-header d-flex justify-content-between align-items-center"},e.createElement("h4",{className:"card-header-title mb-0"},l("members")),e.createElement("div",{className:"col-lg-auto"},e.createElement("div",{className:"input-group"},v&&e.createElement("button",{type:"button",className:"btn btn-outline-primary btn-sm","data-bs-toggle":"modal","data-bs-target":"#settingsModal"},e.createElement("i",{className:"bi bi-plus"}),l("settings")),!E&&s.teamData.privacy===1&&e.createElement("button",{type:"button",className:"btn btn-outline-primary btn-sm",onClick:h},l("join_the_team"))))),e.createElement("div",{className:"card-body"},e.createElement("ul",{className:"list-unstyled list-py-2 text-dark mb-0"},N.map(a=>e.createElement("li",{key:a.users.idTeacher},e.createElement("div",{className:"d-flex align-items-center"},e.createElement(i,{className:"d-flex align-items-center me-2",to:`/profile/view-profile/${a.users.idTeacher}`},e.createElement("div",{className:"flex-shrink-0"},e.createElement("span",{className:"avatar avatar-soft-dark","data-toggle":"tooltip","data-placement":"top",title:a.users.name},e.createElement("span",{className:"avatar-initials"},a.users.name.charAt(0).toUpperCase()))),e.createElement("div",{className:"flex-grow-1 ms-3"},e.createElement("h5",{className:"text-hover-primary mb-0"},a.users.name),e.createElement("span",{className:"fs-6 text-body"},a.access)))))),s.teamMembers.filter(a=>a.access!=="Administrador").map(a=>e.createElement("li",{key:a.users.idTeacher},e.createElement("div",{className:"d-flex align-items-center"},e.createElement(i,{className:"d-flex align-items-center me-2",to:`/profile/view-profile/${a.users.idTeacher}`},e.createElement("div",{className:"flex-shrink-0"},e.createElement("span",{className:"avatar avatar-soft-dark","data-toggle":"tooltip","data-placement":"top",title:a.users.name},e.createElement("span",{className:"avatar-initials"},a.users.name.charAt(0).toUpperCase()))),e.createElement("div",{className:"flex-grow-1 ms-3"},e.createElement("h5",{className:"text-hover-primary mb-0"},a.users.name),e.createElement("span",{className:"fs-6 text-body"},a.access)))))))))),e.createElement("div",{className:"col-sm-8"},e.createElement("div",{class:"card"},e.createElement("div",{class:"accordion-header",id:"headingOne"},e.createElement("button",{class:"btn btn-white btn-sm w-100",role:"button","data-bs-toggle":"collapse","data-bs-target":"#collapseOne","aria-expanded":"false","aria-controls":"collapseOne"},"Add Activity")),e.createElement("div",{id:"collapseOne",class:"accordion-collapse collapse","aria-labelledby":"headingOne","data-bs-parent":"#accordionExample"},e.createElement("div",{class:"accordion-body"},E&&e.createElement(B,null)))),e.createElement("div",{className:"card h-30"},e.createElement("div",{className:"card-header"},e.createElement("h4",{className:"card-header-title"},l("activity"))),e.createElement("div",{className:"card-body"},e.createElement("ul",{className:"step step-icon-xs mb-3"},u.length>0?u.map((a,t)=>e.createElement("li",{key:a.idActivityTeam,className:"step-item"},e.createElement("div",{className:"step-content-wrapper"},e.createElement("span",{className:"step-icon"},e.createElement("div",{className:"flex-shrink-0"},e.createElement("span",{className:"avatar avatar-soft-dark"},e.createElement("span",{className:"avatar-initials"},a.users.name.charAt(0).toUpperCase())))),e.createElement("div",{className:"flex-grow-1 ms-3"},e.createElement("h5",{className:"mb-1"},e.createElement("small",{className:"text-muted"},e.createElement(i,{className:"text-dark",to:`/profile/view-profile/${a.users.idTeacher}`},a.users.name)," | ",D(a.CreateDate))),e.createElement("div",{className:"mt-1 text-dark"},s.editModes[t]&&a.users.idTeacher===c.user._userId?e.createElement(e.Fragment,null,e.createElement("div",{className:"quill-custom rounded"},e.createElement(L,{value:s.editedText,onChange:T,placeholder:"Text..",modules:{toolbar:{container:[["bold","italic","underline","strike"],[{list:"ordered"},{list:"bullet"}],["link"]]}},formats:["bold","italic","underline","strike","list","bullet","link"]})),e.createElement("button",{className:"btn btn-primary btn-xs ms-2 mt-2",onClick:()=>k(a.idActivityTeam)},l("save")),e.createElement("button",{className:"btn btn-ghost-secondary btn-xs ms-2 mt-2",onClick:()=>y(t)},l("cancel"))):e.createElement(e.Fragment,null,e.createElement("div",{dangerouslySetInnerHTML:{__html:a.descriptionActivityTeam}}),a.fileName&&e.createElement("ul",{className:"list-group list-group-sm"},e.createElement("li",{className:"list-group-item list-group-item-light"},e.createElement("div",{className:"row gx-1"},e.createElement("div",{className:"col-sm-4"},e.createElement("div",{className:"d-flex"},e.createElement("div",{className:"flex-shrink-0"},e.createElement("img",{className:"avatar avatar-xs",src:"../assets/svg/components/placeholder-img-format.svg",alt:"Image Description"})),e.createElement("div",{className:"flex-grow-1 text-truncate ms-2"},e.createElement("span",null,a.fileName,e.createElement("span",{className:"d-block small text-muted"},C(a.fileSize)),e.createElement("span",null,e.createElement(i,{to:`http://localhost:8081/api/files/${a.fileName}`,download:!0}," ",l("download")))))))))),a.users.idTeacher===c.user._userId?e.createElement("div",{className:"d-flex justify-content-end"},e.createElement("button",{type:"button",className:"btn btn-outline-primary btn-xs mt-2",onClick:()=>x(t,a)},l("edit")),e.createElement("button",{type:"button",className:"btn btn-outline-danger btn-xs ms-2 mt-2",onClick:()=>w(t,a.idActivityTeam)},l("delete"))):null)))))):e.createElement("p",null,l("no_team_activity_data")))))))),e.createElement("div",{className:"modal fade",id:"settingsModal",tabIndex:"-1",role:"dialog","aria-labelledby":"settingsModalTitle","aria-hidden":"true"},e.createElement("div",{className:"modal-dialog modal-lg modal-dialog-centered",role:"document"},e.createElement("div",{className:"modal-content"},e.createElement("div",{className:"modal-header"},e.createElement("h3",{id:"settingsModalTitle",className:"modal-title"},l("settings")),e.createElement("button",{type:"button",className:"btn btn-ghost-secondary btn-icon btn-sm","data-bs-dismiss":"modal","aria-label":"Close"},e.createElement("i",{className:"bi-x-lg"}))),e.createElement("div",{className:"modal-body"},e.createElement("h5",null,l("text_info_setiting_team_1")),e.createElement("p",null,l("text_info_setiting_team_2")),e.createElement("div",{className:"mb-4"},e.createElement("div",{className:"input-group mb-2 mb-sm-0"},e.createElement("input",{className:"form-control",type:"email",id:"email",value:s.inviteFormData.name,onChange:p,placeholder:"Search for emails"}),e.createElement("div",{className:"input-group-append input-group-append-last-sm-down-none"},e.createElement("div",{className:"tom-select-custom tom-select-custom-end"},e.createElement("select",{className:"js-select form-select tom-select-custom-form-select-invite-user",id:"access",value:s.inviteFormData.access,onChange:p},e.createElement("option",{value:"Convidado"},l("guest")),e.createElement("option",{value:"Administrador"},l("administrator")))),e.createElement("button",{className:"btn btn-primary d-none d-sm-inline-block",onClick:g},l("invite"))))),e.createElement("h5",null,l("text_info_setiting_team_3")," ",s.teamData.nameTeam),e.createElement("p",null,l("text_info_setiting_team_4")),e.createElement("ul",{className:"list-unstyled list-py-2"},s.teamMembers.map((a,t)=>e.createElement("li",{key:`${a.id}-${t}`},e.createElement("div",{className:"d-flex"},e.createElement("div",{className:"flex-shrink-0"},e.createElement("span",{className:"avatar avatar-soft-dark","data-toggle":"tooltip","data-placement":"top",title:a.users.name},e.createElement("span",{className:"avatar-initials"},a.users.name.charAt(0).toUpperCase()))),e.createElement("div",{className:"flex-grow-1 ms-3"},e.createElement("div",{className:"row align-items-center"},e.createElement("div",{className:"col-sm"},e.createElement("h5",{className:"text-body mb-0"},a.users.name),e.createElement("span",{className:"d-block fs-6"},a.users.email)))))))),v?e.createElement("label",{className:"row form-check form-switch",htmlFor:"addTeamPreferencesNewProjectSwitch1"},e.createElement("span",{className:"col-8 col-sm-9 ms-0"},e.createElement("i",{className:"bi bi-gear text-primary me-2"}),e.createElement("span",{className:"text-dark"},l("team_status"),e.createElement("div",{className:`form-text badge bg-soft-primary text-${s.teamData.privacy===1?"success":"danger"} rounded-pill me-1`},s.teamData.privacy===1?`${l("public")}`:`${l("private")}`," ",e.createElement("i",{className:`bi bi-${s.teamData.privacy===1?"globe2":"lock"}`})))),e.createElement("span",{className:"col-4 col-sm-3 text-end"},e.createElement("input",{type:"checkbox",className:"form-check-input",id:"addTeamPreferencesNewProjectSwitch1",defaultChecked:s.teamData.privacy===1,onChange:f}))):null)))))}export{q as default};
