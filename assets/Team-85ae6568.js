import{r as m,C as _,h as A,u as M,j as e,L as d,J as $,K as I,M as S,N as E,O as F,P}from"./index-42ce2823.js";import{d as B,R as L}from"./Other-b01c68e5.js";import"./index-63c2f2d1.js";function z(){const n=m.useContext(_),[t,r]=m.useState({editModes:{},editedText:"",teamData:null,teamActivity:null,teamMembers:null,loading:!0,error:null,inviteFormData:{email:"",access:"Convidado"}}),{teamId:c}=A(),{t:i}=M(),o=n.user._userId;m.useEffect(()=>{(async()=>{try{if(n.user._isAuth){const s=await $(c);r(l=>({...l,teamData:s.team,teamMembers:s.teamMembers,teamActivity:s.teamActivity,loading:!1}))}else r(s=>({...s,loading:!1}))}catch(s){r(l=>({...l,error:s.message,loading:!1}))}})()},[n.user._isAuth,c]);const h=t.teamActivity?[...t.teamActivity].sort((a,s)=>new Date(s.CreateDate)-new Date(a.CreateDate)):[],v=t.teamMembers?t.teamMembers.filter(a=>a.access==="Administrador"):[],b=async()=>{const{email:a}=t.inviteFormData;if(!a.trim()){alert("Por favor, insira um endereço de e-mail válido.");return}try{await I(c,t.inviteFormData),window.location.reload()}catch(s){console.error("Erro ao enviar o convite:",s.message)}},N=async()=>{try{await S(c,o),window.location.reload()}catch(a){console.error(a.message)}},g=async a=>{try{await E(c,a.target.checked?1:0),window.location.reload()}catch(s){console.error("Erro ao atualizar o estado da equipa:",s.message)}},f=a=>r(s=>({...s,editModes:{...s.editModes,[a]:!1}})),y=(a,s)=>r(l=>({...l,editModes:{[a]:!0},editedText:s.descriptionActivityTeam})),w=async a=>{try{await F(a),window.location.reload()}catch(s){console.error("Erro ao eliminar membro da equipa:",s.message)}},k=async a=>{try{await P(a,t.editedText),window.location.reload()}catch(s){console.error("Erro ao guardar atividade actualizada:",s.message)}},T=a=>r(s=>({...s,editedText:a})),x=a=>{const{id:s,value:l}=a.target;r(j=>({...j,inviteFormData:{...j.inviteFormData,[s]:l}}))},D=a=>{const s=new Date(a),l=new Date;return s.toDateString()===l.toDateString()?s.toLocaleTimeString("default",{hour:"numeric",minute:"numeric"}):s.toLocaleDateString("default",{day:"numeric",month:"long",year:"numeric"})},C=a=>{const s=["Bytes","KB","MB","GB","TB"],l=Math.floor(Math.log(a)/Math.log(1024));return`${(a/Math.pow(1024,l)).toFixed(2)} ${s[l]}`};if(t.loading)return e.jsx("p",{children:"Loading..."});if(t.error)return e.jsxs("p",{children:["Error: ",t.error]});const u=t.teamMembers&&t.teamMembers.some(a=>a.users.idTeacher===o),p=t.teamMembers&&t.teamMembers.some(a=>a.users.idTeacher===o&&a.access==="Administrador");return e.jsxs("div",{children:[e.jsxs("main",{id:"content",role:"main",className:"container mt-4",children:[e.jsx("div",{className:"content container-fluid my-2 card rounded shadow-sm",children:e.jsx("div",{className:"row align-items-end",children:e.jsxs("div",{className:"col-sm",children:[e.jsx("nav",{"aria-label":"breadcrumb",children:e.jsx("ol",{className:"breadcrumb breadcrumb-no-gutter pt-3",children:e.jsx("li",{className:"breadcrumb-item",children:e.jsxs(d,{to:`/team/${t.teamData.idTeam}`,children:[i("teams")," - ",t.teamData.idTeam]})})})}),e.jsxs("h1",{className:"page-header-title",children:["#",t.teamData.nameTeam]}),e.jsx("p",{children:t.teamData.descriptionTeam}),e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("span",{className:"text-dark pb-3",children:[i("team_status"),e.jsxs("div",{className:`form-text badge bg-soft-primary text-${t.teamData.privacy===1?"success":"danger"} rounded-pill me-1`,children:[t.teamData.privacy===1?"Publico":"Privado"," ",e.jsx("i",{className:`bi bi-${t.teamData.privacy===1?"globe2":"lock"}`})]})]}),e.jsxs("span",{className:"card-subtitle pb-3",children:[i("industry")," ",e.jsx("a",{className:"form-text badge bg-soft-primary text-primary rounded-pill me-1",href:"#",children:t.teamData.areasWork})]})]})]})})}),e.jsxs("div",{className:"row mt-4 mb-4",children:[e.jsx("div",{className:"col-lg-4",children:e.jsxs("div",{className:"js-sticky-block card mb-3 mb-lg-5",children:[e.jsxs("div",{className:"card-header d-flex justify-content-between align-items-center",children:[e.jsx("h4",{className:"card-header-title mb-0",children:i("members")}),e.jsx("div",{className:"col-lg-auto",children:e.jsxs("div",{className:"input-group",children:[p&&e.jsxs("button",{type:"button",className:"btn btn-outline-primary btn-sm","data-bs-toggle":"modal","data-bs-target":"#settingsModal",children:[e.jsx("i",{className:"bi bi-plus"}),i("settings")]}),!u&&t.teamData.privacy===1&&e.jsx("button",{type:"button",className:"btn btn-outline-primary btn-sm",onClick:N,children:i("join_the_team")})]})})]}),e.jsx("div",{className:"card-body",children:e.jsxs("ul",{className:"list-unstyled list-py-2 text-dark mb-0",children:[v.map(a=>e.jsx("li",{children:e.jsx("div",{className:"d-flex align-items-center",children:e.jsxs(d,{className:"d-flex align-items-center me-2",to:`/profile/view-profile/${a.users.idTeacher}`,children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("span",{className:"avatar avatar-soft-dark","data-toggle":"tooltip","data-placement":"top",title:a.users.name,children:e.jsx("span",{className:"avatar-initials",children:a.users.name.charAt(0).toUpperCase()})})}),e.jsxs("div",{className:"flex-grow-1 ms-3",children:[e.jsx("h5",{className:"text-hover-primary mb-0",children:a.users.name}),e.jsx("span",{className:"fs-6 text-body",children:a.access})]})]})})},a.users.idTeacher)),t.teamMembers.filter(a=>a.access!=="Administrador").map(a=>e.jsx("li",{children:e.jsx("div",{className:"d-flex align-items-center",children:e.jsxs(d,{className:"d-flex align-items-center me-2",to:`/profile/view-profile/${a.users.idTeacher}`,children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("span",{className:"avatar avatar-soft-dark","data-toggle":"tooltip","data-placement":"top",title:a.users.name,children:e.jsx("span",{className:"avatar-initials",children:a.users.name.charAt(0).toUpperCase()})})}),e.jsxs("div",{className:"flex-grow-1 ms-3",children:[e.jsx("h5",{className:"text-hover-primary mb-0",children:a.users.name}),e.jsx("span",{className:"fs-6 text-body",children:a.access})]})]})})},a.users.idTeacher))]})})]})}),e.jsxs("div",{className:"col-sm-8",children:[e.jsxs("div",{class:"card",children:[e.jsx("div",{class:"accordion-header",id:"headingOne",children:e.jsx("button",{class:"btn btn-white btn-sm w-100",role:"button","data-bs-toggle":"collapse","data-bs-target":"#collapseOne","aria-expanded":"false","aria-controls":"collapseOne",children:"Add Activity"})}),e.jsx("div",{id:"collapseOne",class:"accordion-collapse collapse","aria-labelledby":"headingOne","data-bs-parent":"#accordionExample",children:e.jsx("div",{class:"accordion-body",children:u&&e.jsx(B,{})})})]}),e.jsxs("div",{className:"card h-30",children:[e.jsx("div",{className:"card-header",children:e.jsx("h4",{className:"card-header-title",children:i("activity")})}),e.jsx("div",{className:"card-body",children:e.jsx("ul",{className:"step step-icon-xs mb-3",children:h.length>0?h.map((a,s)=>e.jsx("li",{className:"step-item",children:e.jsxs("div",{className:"step-content-wrapper",children:[e.jsx("span",{className:"step-icon",children:e.jsx("div",{className:"flex-shrink-0",children:e.jsx("span",{className:"avatar avatar-soft-dark",children:e.jsx("span",{className:"avatar-initials",children:a.users.name.charAt(0).toUpperCase()})})})}),e.jsxs("div",{className:"flex-grow-1 ms-3",children:[e.jsx("h5",{className:"mb-1",children:e.jsxs("small",{className:"text-muted",children:[e.jsx(d,{className:"text-dark",to:`/profile/view-profile/${a.users.idTeacher}`,children:a.users.name})," | ",D(a.CreateDate)]})}),e.jsx("div",{className:"mt-1 text-dark",children:t.editModes[s]&&a.users.idTeacher===n.user._userId?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"quill-custom rounded",children:e.jsx(L,{value:t.editedText,onChange:T,placeholder:"Text..",modules:{toolbar:{container:[["bold","italic","underline","strike"],[{list:"ordered"},{list:"bullet"}],["link"]]}},formats:["bold","italic","underline","strike","list","bullet","link"]})}),e.jsx("button",{className:"btn btn-primary btn-xs ms-2 mt-2",onClick:()=>k(a.idActivityTeam),children:i("save")}),e.jsx("button",{className:"btn btn-ghost-secondary btn-xs ms-2 mt-2",onClick:()=>f(s),children:i("cancel")})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{dangerouslySetInnerHTML:{__html:a.descriptionActivityTeam}}),a.fileName&&e.jsx("ul",{className:"list-group list-group-sm",children:e.jsx("li",{className:"list-group-item list-group-item-light",children:e.jsx("div",{className:"row gx-1",children:e.jsx("div",{className:"col-sm-4",children:e.jsxs("div",{className:"d-flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("img",{className:"avatar avatar-xs",src:"../assets/svg/components/placeholder-img-format.svg",alt:"Image Description"})}),e.jsx("div",{className:"flex-grow-1 text-truncate ms-2",children:e.jsxs("span",{children:[a.fileName,e.jsx("span",{className:"d-block small text-muted",children:C(a.fileSize)}),e.jsx("span",{children:e.jsxs(d,{to:`http://localhost:8081/api/files/${a.fileName}`,download:!0,children:[" ",i("download")]})})]})})]})})})})}),a.users.idTeacher===n.user._userId?e.jsxs("div",{className:"d-flex justify-content-end",children:[e.jsx("button",{type:"button",className:"btn btn-outline-primary btn-xs mt-2",onClick:()=>y(s,a),children:i("edit")}),e.jsx("button",{type:"button",className:"btn btn-outline-danger btn-xs ms-2 mt-2",onClick:()=>w(s,a.idActivityTeam),children:i("delete")})]}):null]})})]})]})},a.idActivityTeam)):e.jsx("p",{children:i("no_team_activity_data")})})})]})]})]})]}),e.jsx("div",{className:"modal fade",id:"settingsModal",tabIndex:"-1",role:"dialog","aria-labelledby":"settingsModalTitle","aria-hidden":"true",children:e.jsx("div",{className:"modal-dialog modal-lg modal-dialog-centered",role:"document",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{id:"settingsModalTitle",className:"modal-title",children:i("settings")}),e.jsx("button",{type:"button",className:"btn btn-ghost-secondary btn-icon btn-sm","data-bs-dismiss":"modal","aria-label":"Close",children:e.jsx("i",{className:"bi-x-lg"})})]}),e.jsxs("div",{className:"modal-body",children:[e.jsx("h5",{children:i("text_info_setiting_team_1")}),e.jsx("p",{children:i("text_info_setiting_team_2")}),e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"input-group mb-2 mb-sm-0",children:[e.jsx("input",{className:"form-control",type:"email",id:"email",value:t.inviteFormData.name,onChange:x,placeholder:"Search for emails"}),e.jsxs("div",{className:"input-group-append input-group-append-last-sm-down-none",children:[e.jsx("div",{className:"tom-select-custom tom-select-custom-end",children:e.jsxs("select",{className:"js-select form-select tom-select-custom-form-select-invite-user",id:"access",value:t.inviteFormData.access,onChange:x,children:[e.jsx("option",{value:"Convidado",children:i("guest")}),e.jsx("option",{value:"Administrador",children:i("administrator")})]})}),e.jsx("button",{className:"btn btn-primary d-none d-sm-inline-block",onClick:b,children:i("invite")})]})]})}),e.jsxs("h5",{children:[i("text_info_setiting_team_3")," ",t.teamData.nameTeam]}),e.jsx("p",{children:i("text_info_setiting_team_4")}),e.jsx("ul",{className:"list-unstyled list-py-2",children:t.teamMembers.map((a,s)=>e.jsx("li",{children:e.jsxs("div",{className:"d-flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("span",{className:"avatar avatar-soft-dark","data-toggle":"tooltip","data-placement":"top",title:a.users.name,children:e.jsx("span",{className:"avatar-initials",children:a.users.name.charAt(0).toUpperCase()})})}),e.jsx("div",{className:"flex-grow-1 ms-3",children:e.jsx("div",{className:"row align-items-center",children:e.jsxs("div",{className:"col-sm",children:[e.jsx("h5",{className:"text-body mb-0",children:a.users.name}),e.jsx("span",{className:"d-block fs-6",children:a.users.email})]})})})]})},`${a.id}-${s}`))}),p?e.jsxs("label",{className:"row form-check form-switch",htmlFor:"addTeamPreferencesNewProjectSwitch1",children:[e.jsxs("span",{className:"col-8 col-sm-9 ms-0",children:[e.jsx("i",{className:"bi bi-gear text-primary me-2"}),e.jsxs("span",{className:"text-dark",children:[i("team_status"),e.jsxs("div",{className:`form-text badge bg-soft-primary text-${t.teamData.privacy===1?"success":"danger"} rounded-pill me-1`,children:[t.teamData.privacy===1?`${i("public")}`:`${i("private")}`," ",e.jsx("i",{className:`bi bi-${t.teamData.privacy===1?"globe2":"lock"}`})]})]})]}),e.jsx("span",{className:"col-4 col-sm-3 text-end",children:e.jsx("input",{type:"checkbox",className:"form-check-input",id:"addTeamPreferencesNewProjectSwitch1",defaultChecked:t.teamData.privacy===1,onChange:g})})]}):null]})]})})})]})}export{z as default};
